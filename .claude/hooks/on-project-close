#!/bin/bash

# Hook Claude Code - ArrÃªt automatique du serveur web
# Ce script est exÃ©cutÃ© automatiquement Ã  la fermeture du projet dans Claude Code

echo "ğŸ›‘ ArrÃªt du serveur web des widgets DSFR..."

# VÃ©rifier si le fichier PID existe
if [ -f /tmp/widget-server.pid ]; then
    PID=$(cat /tmp/widget-server.pid)
    
    # VÃ©rifier si le processus existe
    if ps -p $PID > /dev/null 2>&1; then
        # ArrÃªter le serveur
        kill -9 $PID 2>/dev/null
        echo "âœ… Serveur web arrÃªtÃ© (PID: $PID)"
        
        # Supprimer le fichier PID
        rm -f /tmp/widget-server.pid
    else
        echo "â„¹ï¸  Le serveur n'Ã©tait plus en cours d'exÃ©cution"
        rm -f /tmp/widget-server.pid
    fi
else
    echo "â„¹ï¸  Aucun serveur web Ã  arrÃªter"
fi

# Nettoyer le fichier de log
if [ -f /tmp/widget-server.log ]; then
    rm -f /tmp/widget-server.log
fi