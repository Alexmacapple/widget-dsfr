<!DOCTYPE html>
<html lang="fr" data-fr-theme="light">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Table Standard DSFR - SignalConso</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@gouvfr/dsfr@1.14.0/dist/dsfr.min.css">
    
    <style>
        body { overflow-x: hidden; }
        .table-container { overflow-x: auto; overflow-y: hidden; margin: 2rem 0; }
        .status-badge { padding: 0.25rem 0.5rem; border-radius: 3px; font-size: 0.875rem; }
        .status-NA { background: #e5e5e5; color: #666; }
        .status-NonConsulte { background: #ffe9e6; color: #ce0500; }
        .status-PromesseAction { background: #d4f4dd; color: #18753c; }
        .status-Infonde { background: #fff4e6; color: #b34000; }
        .sort-arrow { cursor: pointer; user-select: none; }
        .sort-arrow:hover { color: #000091; }
        .search-controls { background: #f6f6f6; padding: 1.5rem; margin-bottom: 2rem; border-radius: 8px; }
        
        /* Styles pour la modale style DSFR */
        dialog {
            padding: 0;
            border: none;
            border-radius: 0.5rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            max-width: 90vw;
            max-height: 90vh;
            width: 800px;
        }
        
        dialog::backdrop {
            background: rgba(0, 0, 0, 0.5);
        }
        
        .modal-wrapper {
            background: white;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            border-bottom: 1px solid #e5e5e5;
        }
        
        .modal-header-content {
            flex: 1;
        }
        
        .modal-title {
            margin: 0;
            font-size: 1.25rem;
            font-weight: 700;
            color: #161616;
        }
        
        .btn-close-modal {
            background: white;
            border: 2px solid #000091;
            color: #000091;
            border-radius: 0.25rem;
            padding: 0.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            min-width: 2.5rem;
            height: 2.5rem;
        }
        
        .btn-close-modal:hover {
            background: #000091;
            color: white;
        }
        
        .modal-body {
            padding: 1.5rem;
            overflow-y: auto;
            flex: 1;
        }
        
        .modal-info-card {
            background: #f6f6f6;
            padding: 1.25rem;
            border-radius: 0.375rem;
            margin-bottom: 1.5rem;
        }
        
        .modal-info-card h3 {
            margin-top: 0;
            margin-bottom: 1rem;
            color: #161616;
        }
        
        .modal-info-grid {
            display: grid;
            gap: 1rem;
        }
        
        .modal-field-group {
            display: grid;
            grid-template-columns: 140px 1fr;
            align-items: center;
            gap: 1rem;
        }
        
        .modal-field-label {
            font-size: 0.875rem;
            color: #666;
            font-weight: 500;
        }
        
        .modal-field-value {
            font-size: 1rem;
        }
    </style>
</head>
<body>
    <!-- DÉBUT ZONE WIDGET TABLE-STANDARD-001 -->
    <div id="widget-table-standard-001" class="fr-container fr-py-3w">
        <h1 class="fr-h3">Tableau des signalements consommateurs</h1>
        <p class="fr-text--sm">Liste complète des signalements avec tri, recherche et pagination</p>

        <!-- Contrôles de recherche et filtrage -->
        <div class="search-controls">
            <div class="fr-grid-row fr-grid-row--gutters">
                <div class="fr-col-12 fr-col-md-3">
                    <div class="fr-input-group">
                        <label class="fr-label" for="search-text">Recherche textuelle</label>
                        <input class="fr-input" type="text" id="search-text" placeholder="Rechercher...">
                    </div>
                </div>
                
                <div class="fr-col-12 fr-col-md-3">
                    <div class="fr-select-group">
                        <label class="fr-label" for="filter-category">Catégorie</label>
                        <select class="fr-select" id="filter-category">
                            <option value="">Toutes les catégories</option>
                            <option value="AchatInternet">Achat Internet</option>
                            <option value="AchatMagasinInternet">Achat Magasin/Internet</option>
                            <option value="TelephonieFaiMedias">Téléphonie/FAI/Médias</option>
                            <option value="TravauxRenovations">Travaux/Rénovations</option>
                            <option value="VoyageLoisirs">Voyage/Loisirs</option>
                            <option value="ServicesAuxParticuliers">Services aux particuliers</option>
                            <option value="EauGazElectricite">Eau/Gaz/Électricité</option>
                            <option value="BanqueAssuranceMutuelle">Banque/Assurance/Mutuelle</option>
                            <option value="ProduitsObjets">Produits/Objets</option>
                            <option value="Immobilier">Immobilier</option>
                            <option value="Animaux">Animaux</option>
                            <option value="Sante">Santé</option>
                            <option value="VoitureVehicule">Voiture/Véhicule</option>
                            <option value="Cafe-HotelsRestaurants">Café/Hôtels/Restaurants</option>
                        </select>
                    </div>
                </div>

                <div class="fr-col-12 fr-col-md-3">
                    <div class="fr-select-group">
                        <label class="fr-label" for="filter-status">Statut</label>
                        <select class="fr-select" id="filter-status">
                            <option value="">Tous les statuts</option>
                            <option value="NA">Non applicable</option>
                            <option value="NonConsulte">Non consulté</option>
                            <option value="PromesseAction">Promesse action</option>
                            <option value="Infonde">Infondé</option>
                        </select>
                    </div>
                </div>

                <div class="fr-col-12 fr-col-md-3">
                    <div class="fr-select-group">
                        <label class="fr-label" for="items-per-page">Éléments par page</label>
                        <select class="fr-select" id="items-per-page" onchange="changeRowsPerPage()">
                            <option value="10">10</option>
                            <option value="20" selected>20</option>
                            <option value="50">50</option>
                            <option value="100">100</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="fr-mt-2w">
                <button class="fr-btn" onclick="applyFilters()">Appliquer les filtres</button>
                <button class="fr-btn fr-btn--secondary" onclick="resetFilters()">Réinitialiser</button>
                <button class="fr-btn fr-btn--secondary" onclick="exportTableToCSV()">Exporter CSV</button>
            </div>
        </div>

        <!-- Nombre de résultats -->
        <div class="fr-mb-2w">
            <p class="fr-text--sm fr-text--bold">
                <strong id="total-count">0</strong> signalements trouvés
                • Page <strong id="current-page">1</strong> / <strong id="total-pages">1</strong>
            </p>
        </div>

        <!-- Table principale -->
        <div class="table-container">
            <table class="fr-table fr-table--bordered">
                <thead>
                    <tr>
                        <th class="sort-arrow" onclick="sortTable('creationdate')">
                            Date <span id="sort-creationdate">↕</span>
                        </th>
                        <th class="sort-arrow" onclick="sortTable('category')">
                            Catégorie <span id="sort-category">↕</span>
                        </th>
                        <th>Sous-catégories</th>
                        <th class="sort-arrow" onclick="sortTable('dep_name')">
                            Département <span id="sort-dep_name">↕</span>
                        </th>
                        <th class="sort-arrow" onclick="sortTable('reg_name')">
                            Région <span id="sort-reg_name">↕</span>
                        </th>
                        <th class="sort-arrow" onclick="sortTable('status')">
                            Statut <span id="sort-status">↕</span>
                        </th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="table-body">
                    <tr><td colspan="7" style="text-align: center;">Chargement des données...</td></tr>
                </tbody>
            </table>
        </div>

        <!-- Pagination -->
        <nav role="navigation" class="fr-pagination" aria-label="Pagination" id="pagination" style="display: none;">
            <ul class="fr-pagination__list">
                <li>
                    <a class="fr-pagination__link fr-pagination__link--first" 
                       id="first-page" href="#" onclick="goToFirstPage(); return false;">
                        Première page
                    </a>
                </li>
                <li>
                    <a class="fr-pagination__link fr-pagination__link--prev fr-pagination__link--lg-label" 
                       id="prev-page" href="#" onclick="goToPrevPage(); return false;">
                        Page précédente
                    </a>
                </li>
                <li>
                    <a class="fr-pagination__link" id="page-1" href="#" onclick="goToPage(1); return false;">1</a>
                </li>
                <li>
                    <a class="fr-pagination__link" id="page-2" href="#" onclick="goToPage(2); return false;">2</a>
                </li>
                <li>
                    <a class="fr-pagination__link" id="page-3" href="#" onclick="goToPage(3); return false;">3</a>
                </li>
                <li>
                    <a class="fr-pagination__link" id="page-4" href="#" onclick="goToPage(4); return false;">4</a>
                </li>
                <li>
                    <a class="fr-pagination__link" id="page-5" href="#" onclick="goToPage(5); return false;">5</a>
                </li>
                <li>
                    <a class="fr-pagination__link fr-displayed-lg" id="dots">...</a>
                </li>
                <li>
                    <a class="fr-pagination__link fr-pagination__link--next fr-pagination__link--lg-label" 
                       id="next-page" href="#" onclick="goToNextPage(); return false;">
                        Page suivante
                    </a>
                </li>
                <li>
                    <a class="fr-pagination__link fr-pagination__link--last" 
                       id="last-page" href="#" onclick="goToLastPage(); return false;">
                        Dernière page
                    </a>
                </li>
            </ul>
        </nav>
    </div>
    <!-- FIN ZONE WIDGET TABLE-STANDARD-001 -->
    
    <!-- Modale pour les détails -->
    <dialog id="modal-details" role="dialog" aria-labelledby="modal-details-title">
        <div class="modal-wrapper">
            <div class="modal-header">
                <div class="modal-header-content">
                    <h2 id="modal-details-title" class="modal-title">
                        Détails du signalement
                    </h2>
                </div>
                <button class="btn-close-modal" 
                        type="button"
                        title="Fermer" 
                        aria-label="Fermer la fenêtre"
                        onclick="closeModal()">
                    <svg aria-hidden="true" focusable="false" width="24" height="24" viewBox="0 0 24 24" fill="none">
                        <path d="M12 10.586L16.95 5.636L18.364 7.05L13.414 12L18.364 16.95L16.95 18.364L12 13.414L7.05 18.364L5.636 16.95L10.586 12L5.636 7.05L7.05 5.636L12 10.586Z" fill="currentColor"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div id="modal-details-content">
                    <!-- Le contenu sera injecté ici -->
                </div>
            </div>
        </div>
    </dialog>
    
    <script src="https://cdn.jsdelivr.net/npm/@gouvfr/dsfr@1.14.0/dist/dsfr.module.min.js"></script>
    <script>
        let allData = [];
        let filteredData = [];
        let displayedData = [];
        let currentPage = 0;
        let rowsPerPage = 20;
        let currentSort = { field: 'creationdate', desc: true };
        
        async function loadData() {
            try {
                const response = await fetch('https://data.economie.gouv.fr/api/records/1.0/search/?dataset=signalconso&rows=500&sort=-creationdate');
                const data = await response.json();
                
                allData = data.records || [];
                document.getElementById('total-count').textContent = data.nhits.toLocaleString('fr-FR');
                
                applyFilters();
            } catch (error) {
                console.error('Erreur:', error);
                document.getElementById('table-body').innerHTML = 
                    '<tr><td colspan="7" style="text-align: center; color: red;">Erreur de chargement des données</td></tr>';
            }
        }
        
        function applyFilters() {
            filteredData = allData.filter(record => {
                const fields = record.fields || {};
                
                // Recherche textuelle
                const searchText = document.getElementById('search-text').value.toLowerCase();
                if (searchText) {
                    const searchableText = JSON.stringify(fields).toLowerCase();
                    if (!searchableText.includes(searchText)) return false;
                }
                
                // Filtre catégorie
                const filterCategory = document.getElementById('filter-category').value;
                if (filterCategory && fields.category !== filterCategory) return false;
                
                // Filtre statut
                const filterStatus = document.getElementById('filter-status').value;
                if (filterStatus && fields.status !== filterStatus) return false;
                
                return true;
            });
            
            currentPage = 0;
            sortTable(currentSort.field);
        }
        
        function sortTable(field) {
            // Mise à jour de l'indicateur de tri
            document.querySelectorAll('[id^="sort-"]').forEach(el => el.textContent = '↕');
            
            if (currentSort.field === field) {
                currentSort.desc = !currentSort.desc;
            } else {
                currentSort.field = field;
                currentSort.desc = true;
            }
            
            document.getElementById('sort-' + field).textContent = currentSort.desc ? '↓' : '↑';
            
            // Tri des données
            filteredData.sort((a, b) => {
                const valA = a.fields[field] || '';
                const valB = b.fields[field] || '';
                const comparison = valA > valB ? 1 : valA < valB ? -1 : 0;
                return currentSort.desc ? -comparison : comparison;
            });
            
            displayPage();
        }
        
        function displayPage() {
            const tbody = document.getElementById('table-body');
            tbody.innerHTML = '';
            
            if (filteredData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center;">Aucun résultat</td></tr>';
                document.getElementById('pagination').style.display = 'none';
                return;
            }
            
            const start = currentPage * rowsPerPage;
            const end = Math.min(start + rowsPerPage, filteredData.length);
            displayedData = filteredData.slice(start, end);
            
            displayedData.forEach(record => {
                const fields = record.fields || {};
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${fields.creationdate ? new Date(fields.creationdate).toLocaleDateString('fr-FR') : ''}</td>
                    <td><span class="fr-badge fr-badge--sm">${fields.category || ''}</span></td>
                    <td>${fields.subcategories || '-'}</td>
                    <td>${fields.dep_name || ''} (${fields.dep_code || ''})</td>
                    <td>${fields.reg_name || ''}</td>
                    <td><span class="status-badge status-${fields.status}">${fields.status || ''}</span></td>
                    <td>
                        <button class="fr-btn fr-btn--sm fr-btn--tertiary btn-details" 
                                data-recordid="${record.recordid}"
                                title="Voir les détails du signalement" 
                                aria-label="Voir les détails">
                            Voir
                        </button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
            
            updatePagination();
        }
        
        function updatePagination() {
            const pagination = document.getElementById('pagination');
            const totalPages = Math.ceil(filteredData.length / rowsPerPage);
            document.getElementById('current-page').textContent = currentPage + 1;
            document.getElementById('total-pages').textContent = totalPages;
            
            if (totalPages > 1) {
                pagination.style.display = 'block';
                
                // Cacher/afficher les boutons first/last
                document.getElementById('first-page').style.display = currentPage > 0 ? '' : 'none';
                document.getElementById('prev-page').style.display = currentPage > 0 ? '' : 'none';
                document.getElementById('next-page').style.display = currentPage < totalPages - 1 ? '' : 'none';
                document.getElementById('last-page').style.display = currentPage < totalPages - 1 ? '' : 'none';
                
                // Mettre à jour les numéros de page
                const startPage = Math.max(0, currentPage - 2);
                const endPage = Math.min(totalPages - 1, startPage + 4);
                
                for (let i = 1; i <= 5; i++) {
                    const pageLink = document.getElementById('page-' + i);
                    const pageNum = startPage + i;
                    
                    if (pageNum <= totalPages) {
                        pageLink.style.display = '';
                        pageLink.textContent = pageNum;
                        pageLink.setAttribute('data-page', pageNum - 1);
                        
                        if (pageNum - 1 === currentPage) {
                            pageLink.setAttribute('aria-current', 'page');
                            pageLink.classList.add('fr-pagination__link--active');
                        } else {
                            pageLink.removeAttribute('aria-current');
                            pageLink.classList.remove('fr-pagination__link--active');
                        }
                    } else {
                        pageLink.style.display = 'none';
                    }
                }
                
                // Afficher les points si nécessaire
                document.getElementById('dots').style.display = endPage < totalPages - 1 ? '' : 'none';
            } else {
                pagination.style.display = 'none';
            }
        }
        
        // Fonctions de navigation
        function goToFirstPage() {
            currentPage = 0;
            displayPage();
        }
        
        function goToLastPage() {
            const totalPages = Math.ceil(filteredData.length / rowsPerPage);
            currentPage = totalPages - 1;
            displayPage();
        }
        
        function goToPrevPage() {
            if (currentPage > 0) {
                currentPage--;
                displayPage();
            }
        }
        
        function goToNextPage() {
            const totalPages = Math.ceil(filteredData.length / rowsPerPage);
            if (currentPage < totalPages - 1) {
                currentPage++;
                displayPage();
            }
        }
        
        function goToPage(pageNum) {
            const page = parseInt(event.target.getAttribute('data-page'));
            if (!isNaN(page)) {
                currentPage = page;
                displayPage();
            }
        }
        
        function changeRowsPerPage() {
            rowsPerPage = parseInt(document.getElementById('items-per-page').value);
            currentPage = 0;
            displayPage();
        }
        
        function resetFilters() {
            document.getElementById('search-text').value = '';
            document.getElementById('filter-category').value = '';
            document.getElementById('filter-status').value = '';
            applyFilters();
        }
        
        function viewDetails(recordId) {
            const record = allData.find(r => r.recordid === recordId);
            if (record) {
                const fields = record.fields;
                const modalContent = document.getElementById('modal-details-content');
                
                // Création du contenu structuré style DSFR
                modalContent.innerHTML = `
                    <!-- Alert avec référence -->
                    <div class="fr-alert fr-alert--info fr-alert--sm fr-mb-3w">
                        <p class="fr-alert__title">Référence du signalement</p>
                        <p><code>${recordId}</code></p>
                    </div>
                    
                    <!-- Informations principales -->
                    <div class="modal-info-card">
                        <h3 class="fr-h6">
                            Informations générales
                        </h3>
                        <div class="modal-info-grid">
                            <div class="modal-field-group">
                                <div class="modal-field-label">Date de création</div>
                                <div class="modal-field-value">
                                    <strong>${fields.creationdate ? new Date(fields.creationdate).toLocaleDateString('fr-FR', { 
                                        day: 'numeric', 
                                        month: 'long', 
                                        year: 'numeric' 
                                    }) : 'Non renseignée'}</strong>
                                </div>
                            </div>
                            <div class="modal-field-group">
                                <div class="modal-field-label">Catégorie</div>
                                <div class="modal-field-value">
                                    <span class="fr-badge fr-badge--info">${fields.category || 'Non catégorisé'}</span>
                                </div>
                            </div>
                            <div class="modal-field-group">
                                <div class="modal-field-label">Statut actuel</div>
                                <div class="modal-field-value">
                                    <span class="fr-badge fr-badge--${fields.status === 'PromesseAction' ? 'success' : fields.status === 'NonConsulte' ? 'error' : 'grey'}">
                                        ${fields.status || 'NA'}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Localisation -->
                    <div class="modal-info-card">
                        <h3 class="fr-h6">
                            Localisation
                        </h3>
                        <div class="modal-info-grid">
                            <div class="modal-field-group">
                                <div class="modal-field-label">Département</div>
                                <div class="modal-field-value">
                                    <strong>${fields.dep_name || 'Non renseigné'}</strong>
                                    ${fields.dep_code ? ` <span class="fr-badge fr-badge--sm fr-badge--yellow-tournesol">${fields.dep_code}</span>` : ''}
                                </div>
                            </div>
                            <div class="modal-field-group">
                                <div class="modal-field-label">Région</div>
                                <div class="modal-field-value">
                                    <strong>${fields.reg_name || 'Non renseignée'}</strong>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- État du signalement -->
                    <div class="fr-callout fr-callout--blue-ecume">
                        <h3 class="fr-callout__title">
                            État du traitement
                        </h3>
                        <ul class="fr-tags-group">
                            <li>
                                <p class="fr-tag ${fields.signalement_transmis == 1 ? 'fr-tag--green-emeraude' : 'fr-tag--grey'}">
                                    ${fields.signalement_transmis == 1 ? '✓' : '✗'} Transmis
                                </p>
                            </li>
                            <li>
                                <p class="fr-tag ${fields.signalement_lu == 1 ? 'fr-tag--blue-ecume' : 'fr-tag--grey'}">
                                    ${fields.signalement_lu == 1 ? '✓' : '✗'} Lu
                                </p>
                            </li>
                            <li>
                                <p class="fr-tag ${fields.signalement_reponse == 1 ? 'fr-tag--purple-glycine' : 'fr-tag--grey'}">
                                    ${fields.signalement_reponse == 1 ? '✓' : '✗'} Réponse
                                </p>
                            </li>
                        </ul>
                    </div>
                    
                    ${fields.subcategories ? `
                    <div class="modal-info-card">
                        <h3 class="fr-h6">Sous-catégories</h3>
                        <p>${fields.subcategories}</p>
                    </div>
                    ` : ''}
                `;
                
                // Ouvrir la modale
                openModal();
            }
        }
        
        function openModal() {
            const modal = document.getElementById('modal-details');
            if (modal) {
                try {
                    // Utiliser l'API dialog HTML5
                    if (typeof modal.showModal === 'function') {
                        modal.showModal();
                    } else {
                        // Fallback pour les navigateurs qui ne supportent pas showModal
                        modal.setAttribute('open', '');
                        modal.style.display = 'block';
                    }
                } catch (err) {
                    console.error('Erreur ouverture modale:', err);
                    modal.setAttribute('open', '');
                    modal.style.display = 'block';
                }
            } else {
                console.error('Element modal-details non trouvé!');
            }
        }
        
        function closeModal() {
            const modal = document.getElementById('modal-details');
            if (modal) {
                try {
                    // Utiliser l'API dialog HTML5
                    if (typeof modal.close === 'function') {
                        modal.close();
                    } else {
                        // Fallback
                        modal.removeAttribute('open');
                        modal.style.display = 'none';
                    }
                } catch (err) {
                    console.error('Erreur fermeture modale:', err);
                    modal.removeAttribute('open');
                    modal.style.display = 'none';
                }
            }
        }
        
        // Ancienne fonction pour compatibilité
        function closeDetailsModal() {
            closeModal();
        }
        
        // Rendre les fonctions accessibles globalement
        window.viewDetails = viewDetails;
        window.closeModal = closeModal;
        window.openModal = openModal;
        window.closeDetailsModal = closeDetailsModal;
        
        function exportTableToCSV() {
            const headers = ['Date', 'Catégorie', 'Sous-catégories', 'Département', 'Région', 'Statut'];
            const csv = [headers.join(',')];
            
            filteredData.forEach(record => {
                const f = record.fields || {};
                const row = [
                    f.creationdate || '',
                    f.category || '',
                    (f.subcategories || '').replace(/,/g, ';'),
                    `${f.dep_name || ''} (${f.dep_code || ''})`,
                    f.reg_name || '',
                    f.status || ''
                ];
                csv.push(row.map(cell => `"${cell}"`).join(','));
            });
            
            const blob = new Blob([csv.join('\n')], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'signalconso-export.csv';
            link.click();
        }
        
        // Event listeners
        document.getElementById('search-text').addEventListener('keyup', function(e) {
            if (e.key === 'Enter') applyFilters();
        });
        
        // Event delegation pour les boutons détails
        document.addEventListener('click', function(e) {
            if (e.target && e.target.classList.contains('btn-details')) {
                e.preventDefault();
                const recordId = e.target.getAttribute('data-recordid');
                if (recordId) {
                    viewDetails(recordId);
                }
            }
        });
        
        // Polyfill pour dialog si nécessaire
        function setupDialogPolyfill() {
            const modal = document.getElementById('modal-details');
            if (modal && typeof modal.showModal !== 'function') {
                modal.showModal = function() {
                    this.style.display = 'block';
                    this.style.position = 'fixed';
                    this.style.top = '50%';
                    this.style.left = '50%';
                    this.style.transform = 'translate(-50%, -50%)';
                    this.style.zIndex = '9999';
                    this.setAttribute('open', '');
                };
                modal.close = function() {
                    this.style.display = 'none';
                    this.removeAttribute('open');
                };
            }
        }
        
        // Au démarrage
        document.addEventListener('DOMContentLoaded', function() {
            setupDialogPolyfill();
        });
        
        // Charger les données au démarrage
        loadData();
    </script>

</body>
</html>