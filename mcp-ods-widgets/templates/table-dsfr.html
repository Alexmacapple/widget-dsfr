<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Widget Table DSFR - {{DATASET_NAME}}</title>
    
    <!-- DSFR CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@gouvfr/dsfr@1.14.0/dist/dsfr.min.css">
    
    <!-- ODS Widgets CSS après DSFR pour priorité -->
    <link rel="stylesheet" href="https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.min.css">
    
    <style>
        /* Surcharges DSFR pour ODS */
        .fr-table ods-table {
            width: 100%;
        }
        .fr-table__wrapper {
            overflow-x: auto;
        }
        .ods-table {
            font-family: Marianne, arial, sans-serif;
        }
        .ods-table th {
            background-color: var(--background-contrast-grey);
            font-weight: 700;
        }
    </style>
</head>
<body>
    <!-- DÉBUT ZONE WIDGET {{WIDGET_ID}} -->
    <div id="widget-{{WIDGET_ID}}" class="fr-container fr-my-4w" ng-app="ods-widgets">
        <ods-dataset-context context="ctx" 
                             ctx-dataset="{{DATASET_ID}}"
                             ctx-domain="{{DOMAIN}}"
                             ctx-apikey="{{API_KEY}}">
            
            <!-- En-tête du widget -->
            <div class="fr-mb-3w">
                <h2 class="fr-h3">{{WIDGET_TITLE}}</h2>
                <p class="fr-text--sm">{{WIDGET_DESCRIPTION}}</p>
            </div>
            
            <!-- Filtres et recherche -->
            <div class="fr-grid-row fr-grid-row--gutters fr-mb-3w">
                <div class="fr-col-12 fr-col-md-8">
                    <div role="search" class="fr-search-bar">
                        <label class="fr-label" for="search-{{WIDGET_ID}}">Rechercher</label>
                        <input 
                            class="fr-input" 
                            type="search" 
                            id="search-{{WIDGET_ID}}"
                            name="search"
                            ng-model="ctx.parameters['q']"
                            placeholder="Rechercher...">
                        <button class="fr-btn" type="submit">
                            Rechercher
                        </button>
                    </div>
                </div>
                <div class="fr-col-12 fr-col-md-4">
                    <ods-clear-all-filters context="ctx">
                        <button class="fr-btn fr-btn--secondary fr-btn--sm">
                            Réinitialiser les filtres
                        </button>
                    </ods-clear-all-filters>
                </div>
            </div>
            
            <!-- Table avec structure DSFR -->
            <div class="fr-table fr-table--bordered">
                <div class="fr-table__wrapper">
                    <div class="fr-table__container">
                        <ods-table 
                            context="ctx"
                            sort="{{SORT_FIELD}}"
                            displayed-fields="{{DISPLAYED_FIELDS}}">
                        </ods-table>
                    </div>
                </div>
            </div>
            
            <!-- Pagination -->
            <div class="fr-mt-3w">
                <ods-pager context="ctx" pager-size="10"></ods-pager>
            </div>
            
            <!-- Export -->
            <div class="fr-mt-3w">
                <p class="fr-text--sm">Exporter les données :</p>
                <div class="fr-btns-group fr-btns-group--inline">
                    <ods-export-api 
                        context="ctx"
                        format="csv">
                        <button class="fr-btn fr-btn--secondary fr-btn--sm">
                            Télécharger CSV
                        </button>
                    </ods-export-api>
                    <ods-export-api 
                        context="ctx"
                        format="xlsx">
                        <button class="fr-btn fr-btn--secondary fr-btn--sm">
                            Télécharger Excel
                        </button>
                    </ods-export-api>
                </div>
            </div>
            
        </ods-dataset-context>
    </div>
    <!-- FIN ZONE WIDGET {{WIDGET_ID}} -->
    
    <!-- Angular et dépendances -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.2/angular.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular-sanitize/1.8.2/angular-sanitize.min.js"></script>
    
    <!-- ODS Widgets -->
    <script src="https://static.opendatasoft.com/ods-widgets/latest-v2/ods-widgets.min.js"></script>
    
    <!-- DSFR JS -->
    <script src="https://cdn.jsdelivr.net/npm/@gouvfr/dsfr@1.14.0/dist/dsfr.module.min.js"></script>
</body>
</html>